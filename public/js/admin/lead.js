var app=new Vue({el:"#app",mixins:[main_mixin,message_mixin,listing_mixin,delete_mixin],data:{route:"/admin/api/leads",deleteRoute:"/admin/leads/delete/",deleteLink:"",result_message:"",warning_message:"",deletedIndex:0,totalLeads:0,porcentagemLeads:0,isSearch:!1,show_result:!1},methods:{init:function(){this.getLeads(),this.loadLead(),this.setSortPagination("-created_at")},loadLead:function(){app.$data.carregando=!1,$.ajax({url:base_url+"/admin/api/leads?page="+this.pagination.page+"&limit="+this.pagination.limit+"&q="+this.pagination.q+"&sort="+this.pagination.sort+"&fields="+this.pagination.fields,method:"GET",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(a){app.$data.carregando=!1,app.$data.paginator=a.pagination,app.$data.registros=a.registros,app.$data.registros.length<=0&&(app.$data.show_result=!0,app.$data.result_message=a.msg,app.$data.isSearch=!1),null!=app.$data.registros.data&&app.$data.registros.data.length>0&&1==app.$data.isSearch&&(app.$data.show_result=!0,app.$data.result_message=a.msg,app.$data.isSearch=!1)}).fail(function(a){app.$data.carregando=!1,app.$data.warning=!0,a.msg?app.$data.warning_message=a.msg:app.$data.warning_message="Ocorreu um erro, tente novamente mais tarde.",app.$data.paginator=a.responseJSON.pagination,app.$data.registros=a.responseJSON.registros})},search:function(a){app.$data.warning=!1,app.$data.show_result=!1,a.preventDefault(),this.pagination.page=1,this.pagination.sort="-created_at",this.isSearch=!0,this.loadLead()},getLeads:function(){$.ajax({url:base_url+"/admin/api/total/leads"}).done(function(a){app.$data.totalLeads=a.total,app.$data.porcentagemLeads=100})},closeResults:function(){this.show_result=!1,location.reload()},donwloadLeads:function(){window.open(base_url+"/admin/leads/export","blank")}}});app.$data.base_url=base_url,app.init();
