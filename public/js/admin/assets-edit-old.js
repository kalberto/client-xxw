$(window).on("load",function(){$("#asset-type-select").on("change",function(){app.$data.asset.tipo=$(this).val(),1==$(this).val()?$("input[name='asset_video']").val(void 0):2==$(this).val()&&$("input[name='asset_image']").val(void 0)})});var app=new Vue({el:"#app",data:{page_edit:!0,msg:"",saved:!1,success_message:"Editado com sucesso!",sending_message:"Enviando..",carregando_upload:!1,carregando_edit:!1,taxa_upload:0,tipo:[{id:1,text:"Imagem"},{id:2,text:"VÃ­deo"}],asset:{tipo:0,nome:"",legenda:"",alias:"medias"},media:{},base_url:""},methods:{editAsset:function(a){$(".form");this.carregando_upload=!0,this.carregando_edit=!0,null==this.asset.file?(this.sending_message="Salvando..",$.ajax({url:base_url+"/admin/api/assets/"+a,method:"POST",data:app.$data.asset,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}).done(function(a){app.$data.carregando_edit=!1,app.$data.saved=!0,setTimeout(function(){app.$data.saved=!1},5e3),app.$data.success_message=a.msg,scrollToTopCorrec()}).fail(function(a){if(app.$data.carregando_edit=!1,app.$data.carregando_edit=!1,a.responseJSON.error_validate){var e=a.responseJSON.error_validate;insertErrorsOnForm("form-assets",e)}})):this.saveWithFile(a)},addFile:function(){this.asset.file=this.$refs.file.files},load:function(){$.ajax({url:base_url+"/admin/api/assets/"+id,method:"GET"}).done(function(a){app.$data.asset.nome=a.media.nome,app.$data.asset.legenda=a.media.legenda,app.$data.asset.tipo=a.media.tipo,app.$data.media=a.media,$("#asset-type-select").val(app.$data.asset.tipo)})},saveWithFile:function(a){$(".form");this.sending_message="Enviando..";var e=new FormData;$("#upload_progress_bar").width="0%",e.append("file",this.asset.file[0]),e.append("nome",this.asset.nome),e.append("tipo",this.asset.tipo),e.append("legenda",this.asset.legenda),e.append("alias",this.asset.alias),this.$http.post(base_url+"/admin/api/assets/"+a,e,{headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},uploadProgress:function(a){var e=100*a.loaded/a.total;$("#upload_progress_bar").width(e+"%"),100==e&&(app.$data.carregando_upload=!1,app.$data.sending_message="Salvando..")},emulateJSON:!0}).then(function(a){app.$data.carregando_edit=!1,app.$data.saved=!0,setTimeout(function(){app.$data.saved=!1},5e3),app.$data.success_message=a.body.msg,scrollToTopCorrec()},function(a){if(a.body.error_validate){var e=a.body.error_validate;insertErrorsOnForm("form-assets",e)}})}}});app.$data.base_url=base_url,app.load();
